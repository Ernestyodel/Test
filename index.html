<!DOCTYPE html><html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TonFi — Passive Income • Treasury • Fun</title>
  <meta name="description" content="TonFi 2.0 — A TON‑native, community‑powered token with transparent treasury, passive income reflections, and playful utility." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root{
      --ton:#0098EA;
      --ink:#0B1220;
      --ink-2:#0f172a;
      --card:#0f1b2d;
      --muted:#7ea9c9;
      --glass:rgba(255,255,255,.06);
    }
    html,body{background:radial-gradient(1200px 800px at 10% -10%, rgba(0,152,234,.25), transparent 40%), linear-gradient(180deg, #05101f, #030913 60%); color:#e6f2ff;}
    .glass{background:var(--glass); backdrop-filter:blur(8px); border:1px solid rgba(255,255,255,.08)}
    .rain-wrap{position:fixed; inset:0; pointer-events:none; overflow:hidden; z-index:0; opacity:.15}
    .drop{position:absolute; top:-10%; font-size:20px; animation:fall linear infinite;}
    @keyframes fall{to{transform:translateY(120vh) rotate(180deg); opacity:.8}}
    .icon{width:20px; height:20px; display:inline-block; vertical-align:middle}
    .kpi-gradient{background:linear-gradient(180deg, rgba(0,152,234,.18), rgba(255,255,255,.00));}
    .section{scroll-margin-top:90px}
    .btn{display:inline-flex; align-items:center; gap:.5rem; padding:.8rem 1rem; border-radius:14px; font-weight:600;}
    .btn-primary{background:var(--ton); color:#00111c}
    .btn-outline{border:1px solid rgba(255,255,255,.12)}
    .badge{border:1px solid rgba(255,255,255,.12); padding:.25rem .55rem; border-radius:.6rem; font-size:.75rem; color:#bfe7ff}
    .card{background:var(--card); border:1px solid rgba(255,255,255,.06); border-radius:20px}
    .grid-auto{display:grid; grid-template-columns:repeat(auto-fit, minmax(250px,1fr)); gap:16px}
    .chip{background:rgba(0,152,234,.12); color:#bfe7ff; padding:.25rem .5rem; border-radius:.5rem}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace}
  </style>
</head>
<body class="font-[Inter] antialiased">
  <div class="rain-wrap" id="rain"></div>  <!-- Transparency & Tracking -->  <section id="transparency" class="section relative z-10 py-10 md:py-14">
    <div class="max-w-6xl mx-auto px-4">
      <h2 class="text-3xl md:text-4xl font-extrabold">Transparency</h2>
      <p class="mt-2 text-sky-100/85">Live view of TonFi’s treasury and liquidity footprint. Connected to TON portfolio tracker API.</p><div class="grid-auto mt-6">
    <div class="card p-6">
      <div class="flex items-center justify-between gap-3 flex-wrap">
        <h3 class="text-xl font-bold">Treasury Wallet</h3>
        <span class="mono text-xs bg-white/5 px-2 py-1 rounded">UQCa8VoKt4HcjEyhmCjY9STErQmRCqPm3n0bJYzG4dQDGLhh</span>
      </div>
      <p class="mt-2 text-sky-100/85">A reserve that accumulates top TON assets and TonFi LP tokens.</p>
      <div class="mt-4 flex flex-wrap gap-3">
        <a class="btn btn-outline" target="_blank" href="https://tonviewer.com/UQCa8VoKt4HcjEyhmCjY9STErQmRCqPm3n0bJYzG4dQDGLhh">Open in Tonviewer</a>
        <button class="btn btn-primary" id="copyAddr">Copy Address</button>
      </div>
      <div class="mt-6 grid md:grid-cols-1 gap-4">
        <div class="glass rounded-xl p-4">
          <div class="text-sm text-sky-200/70">Total Holdings (USD)</div>
          <div id="treasuryValue" class="text-2xl font-bold">Loading...</div>
        </div>
      </div>
      <p class="text-xs text-sky-200/60 mt-3">Data powered by TON API portfolio tracker.</p>
    </div>
  </div>
</div>

  </section>  <script>
    // copy treasury address
    const addr = 'UQCa8VoKt4HcjEyhmCjY9STErQmRCqPm3n0bJYzG4dQDGLhh';
    document.getElementById('copyAddr').addEventListener('click', async () => {
      try{ await navigator.clipboard.writeText(addr); alert('Treasury address copied!'); }catch(e){ alert('Copy failed'); }
    });

    // Portfolio USD value using TonAPI v2 (client-side)
    function fmtUSD(n){ try { return new Intl.NumberFormat('en-US',{style:'currency',currency:'USD',maximumFractionDigits:0}).format(n||0); } catch(_) { return '$' + (n||0).toFixed(0); } }

    async function fetchPortfolioUSD(){
      try {
        // 1) Native TON balance (TonAPI primary)
        const acct = await fetch(`https://tonapi.io/v2/accounts/${addr}`).then(r=>{
          if(!r.ok) throw new Error('TonAPI account rate-limited');
          return r.json();
        });
        const tonNano = Number(acct?.balance) || 0;
        const ton = tonNano / 1e9;

        // 2) TON->USD price (TonAPI primary, CoinGecko fallback)
        let tonUsd = 0;
        try {
          const rates = await fetch('https://tonapi.io/v2/rates?tokens=ton&currencies=usd').then(r=>{
            if(!r.ok) throw new Error('TonAPI rates rate-limited');
            return r.json();
          });
          tonUsd = (rates?.rates?.TON?.prices?.USD) ?? (rates?.rates?.ton?.prices?.USD) ?? 0;
        } catch(_) {
          // Fallback: CoinGecko
          try {
            const cg = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=the-open-network&vs_currencies=usd').then(r=>r.json());
            tonUsd = Number(cg?.['the-open-network']?.usd) || 0;
          } catch(e2) {
            console.warn('CoinGecko fallback failed', e2);
            tonUsd = 0;
          }
        }

        // 3) Jetton balances with USD prices (TonAPI best-effort)
        let jetUsd = 0;
        try {
          const jet = await fetch(`https://tonapi.io/v2/accounts/${addr}/jettons?limit=100`).then(r=>{
            if(!r.ok) throw new Error('TonAPI jettons rate-limited');
            return r.json();
          });
          if (Array.isArray(jet?.balances)) {
            for (const j of jet.balances) {
              const dec = Number(j?.jetton?.decimals) || 9;
              const amt = (Number(j?.balance) || 0) / (10 ** dec);
              const price = Number(j?.price?.prices?.USD) || 0; // if missing, count as 0
              jetUsd += amt * price;
            }
          }
        } catch (err) {
          console.warn('Jetton price fetch skipped', err);
        }

        const totalUsd = (ton * tonUsd) + jetUsd;
        const usdText = fmtUSD(totalUsd);
        const el1 = document.getElementById('treasuryValue');
        const el2 = document.getElementById('kpiTreasury');
        if (el1) el1.textContent = usdText;
        if (el2) el2.textContent = usdText;
      } catch (e) {
        console.error('Portfolio fetch failed', e);
        const el1 = document.getElementById('treasuryValue');
        if (el1) el1.textContent = '—';
      }
    }

    fetchPortfolioUSD();
  </script></body>
</html>
